---
- lineinfile:
    path: /etc/apt/sources.list
    # regexp: '^deb .* main$'
    line: deb http://deb.debian.org/debian bullseye main

- name: apt python update
  command: apt-get update

- name: install python-apt
  command: apt-get install -y python-apt

- name: install tools
  apt:
    update_cache: yes
    state: present
    name:
      # necessary packets
      - batctl
      - pdns-recursor
      - bird2
      - fastd
      - git
      - haveged
      - iproute2
      - iptables-persistent
      - isc-dhcp-server
      - openssh-server
      - prometheus-bind-exporter
      - prometheus-node-exporter
      - python-apt
      - radvd
      # tools for debugging
      - bridge-utils
      - apt-file
      - curl
      - dnsutils
      - htop
      - iftop
      - openssh-client
      - wget
      - iperf3
      - tcpdump
      - vim
      - iputils-ping
      - socat
      - jq
      - python3-yaml

- name: load batman-adv
  modprobe:
    name: batman-adv
    state: present
